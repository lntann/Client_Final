{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/THIS PC/Desktop/An/Client_Final/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/THIS PC/Desktop/An/Client_Final/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/THIS PC/Desktop/An/Client_Final/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useState}from\"react\";import\"./write.css\";import axios from\"axios\";import{AuthContext}from\"../../context/AuthContext\";import{useNavigate}from'react-router-dom';import{axiosInstance}from'../../config';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Write(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),desc=_useState4[0],setDesc=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),file=_useState6[0],setFile=_useState6[1];var _useContext=useContext(AuthContext),user=_useContext.user;var navigate=useNavigate();var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var newPost,data,filename,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();newPost={username:user.username,title:title,desc:desc};if(!file){_context.next=15;break;}data=new FormData();filename=Date.now()+file.name;data.append(\"name\",filename);data.append(\"file\",file);newPost.photo=filename;_context.prev=8;_context.next=11;return axiosInstance.post(\"/upload\",data);case 11:_context.next=15;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](8);case 15:_context.prev=15;_context.next=18;return axiosInstance.post(\"/posts\",newPost);case 18:res=_context.sent;/*#__PURE__*/_jsx(Navigate,{to:\"/\"});console.log(res.data._id);_context.next=25;break;case 23:_context.prev=23;_context.t1=_context[\"catch\"](15);case 25:case\"end\":return _context.stop();}}},_callee,null,[[8,13],[15,23]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"write\",children:[file&&/*#__PURE__*/_jsx(\"img\",{className:\"writeImg\",src:URL.createObjectURL(file),alt:\"\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"writeForm\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"writeFormGroup\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\",children:/*#__PURE__*/_jsx(\"i\",{className:\"writeIcon fas fa-plus\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"fileInput\",style:{display:\"none\"},onChange:function onChange(e){return setFile(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",className:\"writeInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"writeFormGroup\",children:/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Tell your story...\",type:\"text\",className:\"writeInput writeText\",onChange:function onChange(e){return setDesc(e.target.value);}})}),/*#__PURE__*/_jsx(\"button\",{className:\"writeSubmit\",type:\"submit\",children:\"Publish\"})]})]});}","map":{"version":3,"names":["useContext","useState","axios","AuthContext","useNavigate","axiosInstance","Write","title","setTitle","desc","setDesc","file","setFile","user","navigate","handleSubmit","e","preventDefault","newPost","username","data","FormData","filename","Date","now","name","append","photo","post","res","console","log","_id","URL","createObjectURL","display","target","files","value"],"sources":["C:/Users/THIS PC/Desktop/An/Client_Final/src/page/write/Write.jsx"],"sourcesContent":["import { useContext, useState } from \"react\";\r\nimport \"./write.css\";\r\nimport axios from \"axios\";\r\nimport { AuthContext } from \"../../context/AuthContext\";\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { axiosInstance } from '../../config';\r\nexport default function Write() {\r\n  const [title, setTitle] = useState(\"\");\r\n  const [desc, setDesc] = useState(\"\");\r\n  const [file, setFile] = useState(null);\r\n  const { user } = useContext(AuthContext);\r\nconst navigate = useNavigate();\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const newPost = {\r\n      username: user.username,\r\n      title,\r\n      desc,\r\n    };\r\n    if (file) {\r\n      const data =new FormData();\r\n      const filename = Date.now() + file.name;\r\n      data.append(\"name\", filename);\r\n      data.append(\"file\", file);\r\n      newPost.photo = filename;\r\n      try {\r\n        await axiosInstance.post(\"/upload\", data);\r\n      } catch (err) {}\r\n    }\r\n    try {\r\n      const res = await axiosInstance.post(\"/posts\", newPost);\r\n      <Navigate to=\"/\" />\r\n      console.log(res.data._id);\r\n    } catch (err) {}\r\n  };\r\n  return (\r\n    <div className=\"write\">\r\n      {file && (\r\n        <img className=\"writeImg\" src={URL.createObjectURL(file)} alt=\"\" />\r\n      )}\r\n      <form className=\"writeForm\" onSubmit={handleSubmit}>\r\n        <div className=\"writeFormGroup\">\r\n          <label htmlFor=\"fileInput\">\r\n            <i className=\"writeIcon fas fa-plus\"></i>\r\n          </label>\r\n          <input\r\n            type=\"file\"\r\n            id=\"fileInput\"\r\n            style={{ display: \"none\" }}\r\n            onChange={(e) => setFile(e.target.files[0])}\r\n          />\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Title\"\r\n            className=\"writeInput\"\r\n            autoFocus={true}\r\n            onChange={e=>setTitle(e.target.value)}\r\n          />\r\n        </div>\r\n        <div className=\"writeFormGroup\">\r\n          <textarea\r\n            placeholder=\"Tell your story...\"\r\n            type=\"text\"\r\n            className=\"writeInput writeText\"\r\n            onChange={e=>setDesc(e.target.value)}\r\n          ></textarea>\r\n        </div>\r\n        <button className=\"writeSubmit\" type=\"submit\">\r\n          Publish\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}