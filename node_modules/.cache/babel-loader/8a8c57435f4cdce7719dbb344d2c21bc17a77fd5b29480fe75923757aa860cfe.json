{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/THIS PC/Desktop/An/Client_Final/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/THIS PC/Desktop/An/Client_Final/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/THIS PC/Desktop/An/Client_Final/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from\"axios\";import{useContext,useEffect,useState}from\"react\";import{useLocation}from\"react-router\";import{Link}from\"react-router-dom\";import{AuthContext}from\"../../context/AuthContext\";import\"./singlePost.css\";import{axiosInstance}from'../../config';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function SinglePost(){var location=useLocation();var path=location.pathname.split(\"/\")[2];var _useState=useState({}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var PF=\"https://api-hl25.onrender.com/api/images/\";var _useContext=useContext(AuthContext),user=_useContext.user;var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),desc=_useState6[0],setDesc=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),updateMode=_useState8[0],setUpdateMode=_useState8[1];useEffect(function(){var getPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axiosInstance.get(\"/posts/\"+path);case 2:res=_context.sent;setPost(res.data);setTitle(res.data.title);setDesc(res.data.desc);case 6:case\"end\":return _context.stop();}}},_callee);}));return function getPost(){return _ref.apply(this,arguments);};}();getPost();},[path]);var handleDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axiosInstance.delete(\"/posts/\".concat(post._id),{data:{username:user.username}});case 3:window.location.replace(\"/\");_context2.next=8;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);case 8:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function handleDelete(){return _ref2.apply(this,arguments);};}();var handleUpdate=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axiosInstance.put(\"/posts/\".concat(post._id),{username:user.username,title:title,desc:desc});case 3:setUpdateMode(false);_context3.next=8;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);case 8:case\"end\":return _context3.stop();}}},_callee3,null,[[0,6]]);}));return function handleUpdate(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"singlePost\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostWrapper\",children:[post.photo&&/*#__PURE__*/_jsx(\"img\",{src:PF+post.photo,alt:\"\",className:\"singlePostImg\"}),updateMode?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:title,className:\"singlePostTitleInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}}):/*#__PURE__*/_jsxs(\"h1\",{className:\"singlePostTitle\",children:[title,post.username===(user===null||user===void 0?void 0:user.username)&&/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostEdit\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"singlePostIcon far fa-edit\",onClick:function onClick(){return setUpdateMode(true);}}),/*#__PURE__*/_jsx(\"i\",{className:\"singlePostIcon far fa-trash-alt\",onClick:handleDelete})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostInfo\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"singlePostAuthor\",children:[\"Author:\",/*#__PURE__*/_jsx(Link,{to:\"/?user=\".concat(post.username),className:\"link\",children:/*#__PURE__*/_jsxs(\"b\",{children:[\" \",post.username]})})]}),/*#__PURE__*/_jsx(\"span\",{className:\"singlePostDate\",children:new Date(post.createdAt).toDateString()})]}),updateMode?/*#__PURE__*/_jsx(\"textarea\",{className:\"singlePostDescInput\",value:desc,onChange:function onChange(e){return setDesc(e.target.value);}}):/*#__PURE__*/_jsx(\"p\",{className:\"singlePostDesc\",children:desc}),updateMode&&/*#__PURE__*/_jsx(\"button\",{className:\"singlePostButton\",onClick:handleUpdate,children:\"Update\"})]})});}","map":{"version":3,"names":["axios","useContext","useEffect","useState","useLocation","Link","AuthContext","axiosInstance","SinglePost","location","path","pathname","split","post","setPost","PF","user","title","setTitle","desc","setDesc","updateMode","setUpdateMode","getPost","get","res","data","handleDelete","delete","_id","username","window","replace","handleUpdate","put","photo","e","target","value","Date","createdAt","toDateString"],"sources":["C:/Users/THIS PC/Desktop/An/Client_Final/src/components/singlePost/SinglePost.jsx"],"sourcesContent":["import axios from \"axios\";\r\nimport { useContext, useEffect, useState } from \"react\";\r\nimport { useLocation } from \"react-router\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { AuthContext  } from \"../../context/AuthContext\";\r\nimport \"./singlePost.css\";\r\nimport { axiosInstance } from '../../config';\r\nexport default function SinglePost() {\r\n  const location = useLocation();\r\n  const path = location.pathname.split(\"/\")[2];\r\n  const [post, setPost] = useState({});\r\n  const PF = \"https://api-hl25.onrender.com/api/images/\";\r\n  const { user } = useContext( AuthContext );\r\n  const [title, setTitle] = useState(\"\");\r\n  const [desc, setDesc] = useState(\"\");\r\n  const [updateMode, setUpdateMode] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const getPost = async () => {\r\n      const res = await axiosInstance.get(\"/posts/\" + path);\r\n      setPost(res.data);\r\n      setTitle(res.data.title);\r\n      setDesc(res.data.desc);\r\n    };\r\n    getPost();\r\n  }, [path]);\r\n\r\n  const handleDelete = async () => {\r\n    try {\r\n      await  axiosInstance.delete(`/posts/${post._id}`, {\r\n        data: { username: user.username },\r\n      });\r\n      window.location.replace(\"/\");\r\n    } catch (err) {}\r\n  };\r\n\r\n  const handleUpdate = async () => {\r\n    try {\r\n      await axiosInstance.put(`/posts/${post._id}`, {\r\n        username: user.username,\r\n        title,\r\n        desc,\r\n      });\r\n      setUpdateMode(false)\r\n    } catch (err) {}\r\n  };\r\n\r\n  return (\r\n    <div className=\"singlePost\">\r\n      <div className=\"singlePostWrapper\">\r\n        {post.photo && (\r\n          <img src={PF + post.photo} alt=\"\" className=\"singlePostImg\" />\r\n        )}\r\n        {updateMode ? (\r\n          <input\r\n            type=\"text\"\r\n            value={title}\r\n            className=\"singlePostTitleInput\"\r\n            autoFocus\r\n            onChange={(e) => setTitle(e.target.value)}\r\n          />\r\n        ) : (\r\n          <h1 className=\"singlePostTitle\">\r\n            {title}\r\n            {post.username === user?.username && (\r\n              <div className=\"singlePostEdit\">\r\n                <i\r\n                  className=\"singlePostIcon far fa-edit\"\r\n                  onClick={() => setUpdateMode(true)}\r\n                ></i>\r\n                <i\r\n                  className=\"singlePostIcon far fa-trash-alt\"\r\n                  onClick={handleDelete}\r\n                ></i>\r\n              </div>\r\n            )}\r\n          </h1>\r\n        )}\r\n        <div className=\"singlePostInfo\">\r\n          <span className=\"singlePostAuthor\">\r\n            Author:\r\n            <Link to={`/?user=${post.username}`} className=\"link\">\r\n              <b> {post.username}</b>\r\n            </Link>\r\n          </span>\r\n          <span className=\"singlePostDate\">\r\n            {new Date(post.createdAt).toDateString()}\r\n          </span>\r\n        </div>\r\n        {updateMode ? (\r\n          <textarea\r\n            className=\"singlePostDescInput\"\r\n            value={desc}\r\n            onChange={(e) => setDesc(e.target.value)}\r\n          />\r\n        ) : (\r\n          <p className=\"singlePostDesc\">{desc}</p>\r\n        )}\r\n        {updateMode && (\r\n          <button className=\"singlePostButton\" onClick={handleUpdate}>\r\n            Update\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}